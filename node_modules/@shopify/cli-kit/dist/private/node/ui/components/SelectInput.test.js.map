{"version":3,"file":"SelectInput.test.js","sourceRoot":"","sources":["../../../../../src/private/node/ui/components/SelectInput.test.tsx"],"names":[],"mappings":"AAAA,OAAO,WAAW,MAAM,kBAAkB,CAAA;AAC1C,OAAO,EAAC,sBAAsB,EAAE,aAAa,EAAE,SAAS,EAAC,MAAM,2BAA2B,CAAA;AAC1F,OAAO,EAAC,QAAQ,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,EAAC,MAAM,QAAQ,CAAA;AACjD,OAAO,KAAK,MAAM,OAAO,CAAA;AACzB,OAAO,EAAC,MAAM,EAAC,MAAM,qBAAqB,CAAA;AAE1C,MAAM,QAAQ,GAAG,UAAU,CAAA;AAC3B,MAAM,UAAU,GAAG,UAAU,CAAA;AAC7B,MAAM,KAAK,GAAG,IAAI,CAAA;AAElB,QAAQ,CAAC,aAAa,EAAE,KAAK,IAAI,EAAE;IACjC,IAAI,CAAC,2BAA2B,EAAE,KAAK,IAAI,EAAE;QAC3C,MAAM,KAAK,GAAG;YACZ;gBACE,KAAK,EAAE,OAAO;gBACd,KAAK,EAAE,OAAO;aACf;YACD;gBACE,KAAK,EAAE,QAAQ;gBACf,KAAK,EAAE,QAAQ;aAChB;YACD;gBACE,KAAK,EAAE,OAAO;gBACd,KAAK,EAAE,OAAO;aACf;SACF,CAAA;QAED,MAAM,cAAc,GAAG,MAAM,CAAC,oBAAC,WAAW,IAAC,KAAK,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,EAAE,GAAE,CAAC,GAAI,CAAC,CAAA;QAEhF,MAAM,sBAAsB,EAAE,CAAA;QAC9B,MAAM,SAAS,CAAC,cAAc,EAAE,QAAQ,CAAC,CAAA;QAEzC,MAAM,CAAC,cAAc,CAAC,SAAS,EAAE,CAAC,CAAC,qBAAqB,CAAC;;;;;;KAMxD,CAAC,CAAA;IACJ,CAAC,CAAC,CAAA;IAEF,IAAI,CAAC,+BAA+B,EAAE,KAAK,IAAI,EAAE;QAC/C,MAAM,KAAK,GAAG;YACZ;gBACE,KAAK,EAAE,OAAO;gBACd,KAAK,EAAE,OAAO;aACf;YACD;gBACE,KAAK,EAAE,QAAQ;gBACf,KAAK,EAAE,QAAQ;aAChB;YACD;gBACE,KAAK,EAAE,OAAO;gBACd,KAAK,EAAE,OAAO;aACf;SACF,CAAA;QAED,MAAM,cAAc,GAAG,MAAM,CAAC,oBAAC,WAAW,IAAC,KAAK,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,EAAE,GAAE,CAAC,GAAI,CAAC,CAAA;QAEhF,MAAM,sBAAsB,EAAE,CAAA;QAC9B,MAAM,SAAS,CAAC,cAAc,EAAE,UAAU,CAAC,CAAA;QAE3C,MAAM,CAAC,cAAc,CAAC,SAAS,EAAE,CAAC,CAAC,qBAAqB,CAAC;;;;;;KAMxD,CAAC,CAAA;IACJ,CAAC,CAAC,CAAA;IAEF,IAAI,CAAC,4BAA4B,EAAE,KAAK,IAAI,EAAE;QAC5C,MAAM,OAAO,GAAG,EAAE,CAAC,EAAE,EAAE,CAAA;QAEvB,MAAM,KAAK,GAAG;YACZ;gBACE,KAAK,EAAE,OAAO;gBACd,KAAK,EAAE,OAAO;aACf;YACD;gBACE,KAAK,EAAE,QAAQ;gBACf,KAAK,EAAE,QAAQ;aAChB;YACD;gBACE,KAAK,EAAE,OAAO;gBACd,KAAK,EAAE,OAAO;aACf;SACF,CAAA;QAED,MAAM,cAAc,GAAG,MAAM,CAAC,oBAAC,WAAW,IAAC,KAAK,EAAE,KAAK,EAAE,QAAQ,EAAE,OAAO,GAAI,CAAC,CAAA;QAE/E,MAAM,sBAAsB,EAAE,CAAA;QAC9B,MAAM,SAAS,CAAC,cAAc,EAAE,UAAU,CAAC,CAAA;QAC3C,MAAM,aAAa,CACjB,GAAG,EAAE,CAAC,cAAc,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,CAAC,EACvC,GAAG,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAChC,CAAA;QAED,MAAM,CAAC,OAAO,CAAC,CAAC,oBAAoB,CAAC,KAAK,CAAC,CAAC,CAAE,CAAC,KAAK,CAAC,CAAA;IACvD,CAAC,CAAC,CAAA;IAEF,IAAI,CAAC,mCAAmC,EAAE,KAAK,IAAI,EAAE;QACnD,MAAM,KAAK,GAAG;YACZ;gBACE,KAAK,EAAE,OAAO;gBACd,KAAK,EAAE,OAAO;aACf;YACD;gBACE,KAAK,EAAE,QAAQ;gBACf,KAAK,EAAE,QAAQ;aAChB;YACD;gBACE,KAAK,EAAE,OAAO;gBACd,KAAK,EAAE,OAAO;gBACd,GAAG,EAAE,IAAI;aACV;SACF,CAAA;QAED,MAAM,cAAc,GAAG,MAAM,CAAC,oBAAC,WAAW,IAAC,KAAK,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,EAAE,GAAE,CAAC,GAAI,CAAC,CAAA;QAEhF,MAAM,sBAAsB,EAAE,CAAA;QAC9B,MAAM,SAAS,CAAC,cAAc,EAAE,GAAG,EAAE,GAAG,CAAC,CAAA;QAEzC,MAAM,CAAC,cAAc,CAAC,SAAS,EAAE,CAAC,CAAC,qBAAqB,CAAC;;;;;;KAMxD,CAAC,CAAA;IACJ,CAAC,CAAC,CAAA;IAEF,IAAI,CAAC,qBAAqB,EAAE,KAAK,IAAI,EAAE;QACrC,MAAM,KAAK,GAAG;YACZ;gBACE,KAAK,EAAE,OAAO;gBACd,KAAK,EAAE,OAAO;aACf;YACD;gBACE,KAAK,EAAE,QAAQ;gBACf,KAAK,EAAE,QAAQ;aAChB;YACD;gBACE,KAAK,EAAE,OAAO;gBACd,KAAK,EAAE,OAAO;gBACd,GAAG,EAAE,GAAG;aACT;SACF,CAAA;QAED,MAAM,cAAc,GAAG,MAAM,CAAC,oBAAC,WAAW,IAAC,KAAK,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,EAAE,GAAE,CAAC,GAAI,CAAC,CAAA;QAEhF,MAAM,sBAAsB,EAAE,CAAA;QAC9B,MAAM,SAAS,CAAC,cAAc,EAAE,GAAG,CAAC,CAAA;QAEpC,MAAM,CAAC,cAAc,CAAC,SAAS,EAAE,CAAC,CAAC,qBAAqB,CAAC;;;;;;KAMxD,CAAC,CAAA;IACJ,CAAC,CAAC,CAAA;IAEF,IAAI,CAAC,2CAA2C,EAAE,KAAK,IAAI,EAAE;QAC3D,MAAM,KAAK,GAAG;YACZ;gBACE,KAAK,EAAE,OAAO;gBACd,KAAK,EAAE,OAAO;aACf;YACD;gBACE,KAAK,EAAE,QAAQ;gBACf,KAAK,EAAE,QAAQ;aAChB;YACD;gBACE,KAAK,EAAE,OAAO;gBACd,KAAK,EAAE,OAAO;aACf;SACF,CAAA;QAED,MAAM,cAAc,GAAG,MAAM,CAAC,oBAAC,WAAW,IAAC,KAAK,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,EAAE,GAAE,CAAC,GAAI,CAAC,CAAA;QAEhF,MAAM,sBAAsB,EAAE,CAAA;QAC9B,MAAM,SAAS,CAAC,cAAc,EAAE,UAAU,CAAC,CAAA;QAC3C,MAAM,SAAS,CAAC,cAAc,EAAE,UAAU,CAAC,CAAA;QAC3C,MAAM,SAAS,CAAC,cAAc,EAAE,UAAU,CAAC,CAAA;QAE3C,MAAM,CAAC,cAAc,CAAC,SAAS,EAAE,CAAC,CAAC,qBAAqB,CAAC;;;;;;KAMxD,CAAC,CAAA;IACJ,CAAC,CAAC,CAAA;IAEF,IAAI,CAAC,gBAAgB,EAAE,KAAK,IAAI,EAAE;QAChC,MAAM,KAAK,GAAG;YACZ,EAAC,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,GAAG,EAAE,GAAG,EAAC;YAC1C,EAAC,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,EAAE,GAAG,EAAC;YAC5C,EAAC,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAC;YAChC,EAAC,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAC;YAClC,EAAC,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,aAAa,EAAC;YACtD,EAAC,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,aAAa,EAAC;YACtD,EAAC,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,SAAS,EAAC;YACpC,EAAC,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,gBAAgB,EAAC;YAC3D,EAAC,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,gBAAgB,EAAC;YACzD,EAAC,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAC;SACjC,CAAA;QAED,MAAM,cAAc,GAAG,MAAM,CAAC,oBAAC,WAAW,IAAC,KAAK,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,EAAE,GAAE,CAAC,GAAI,CAAC,CAAA;QAEhF,MAAM,CAAC,cAAc,CAAC,SAAS,EAAE,CAAC,CAAC,qBAAqB,CAAC;;;;;;;;;;;;;;;;;KAiBxD,CAAC,CAAA;IACJ,CAAC,CAAC,CAAA;AACJ,CAAC,CAAC,CAAA","sourcesContent":["import SelectInput from './SelectInput.js'\nimport {waitForInputsToBeReady, waitForChange, sendInput} from '../../../../testing/ui.js'\nimport {describe, expect, test, vi} from 'vitest'\nimport React from 'react'\nimport {render} from 'ink-testing-library'\n\nconst ARROW_UP = '\\u001B[A'\nconst ARROW_DOWN = '\\u001B[B'\nconst ENTER = '\\r'\n\ndescribe('SelectInput', async () => {\n  test('move up with up arrow key', async () => {\n    const items = [\n      {\n        label: 'First',\n        value: 'first',\n      },\n      {\n        label: 'Second',\n        value: 'second',\n      },\n      {\n        label: 'Third',\n        value: 'third',\n      },\n    ]\n\n    const renderInstance = render(<SelectInput items={items} onSelect={() => {}} />)\n\n    await waitForInputsToBeReady()\n    await sendInput(renderInstance, ARROW_UP)\n\n    expect(renderInstance.lastFrame()).toMatchInlineSnapshot(`\n      \"   (1) First\n         (2) Second\n      \u001b[36m>\u001b[39m  \u001b[36m(3) Third\u001b[39m\n\n         \u001b[2mnavigate with arrows, enter to select\u001b[22m\"\n    `)\n  })\n\n  test('move down with down arrow key', async () => {\n    const items = [\n      {\n        label: 'First',\n        value: 'first',\n      },\n      {\n        label: 'Second',\n        value: 'second',\n      },\n      {\n        label: 'Third',\n        value: 'third',\n      },\n    ]\n\n    const renderInstance = render(<SelectInput items={items} onSelect={() => {}} />)\n\n    await waitForInputsToBeReady()\n    await sendInput(renderInstance, ARROW_DOWN)\n\n    expect(renderInstance.lastFrame()).toMatchInlineSnapshot(`\n      \"   (1) First\n      \u001b[36m>\u001b[39m  \u001b[36m(2) Second\u001b[39m\n         (3) Third\n\n         \u001b[2mnavigate with arrows, enter to select\u001b[22m\"\n    `)\n  })\n\n  test('select item with enter key', async () => {\n    const onEnter = vi.fn()\n\n    const items = [\n      {\n        label: 'First',\n        value: 'first',\n      },\n      {\n        label: 'Second',\n        value: 'second',\n      },\n      {\n        label: 'Third',\n        value: 'third',\n      },\n    ]\n\n    const renderInstance = render(<SelectInput items={items} onSelect={onEnter} />)\n\n    await waitForInputsToBeReady()\n    await sendInput(renderInstance, ARROW_DOWN)\n    await waitForChange(\n      () => renderInstance.stdin.write(ENTER),\n      () => onEnter.mock.calls.length,\n    )\n\n    expect(onEnter).toHaveBeenCalledWith(items[1]!.value)\n  })\n\n  test('handles keys with multiple digits', async () => {\n    const items = [\n      {\n        label: 'First',\n        value: 'first',\n      },\n      {\n        label: 'Second',\n        value: 'second',\n      },\n      {\n        label: 'Tenth',\n        value: 'tenth',\n        key: '10',\n      },\n    ]\n\n    const renderInstance = render(<SelectInput items={items} onSelect={() => {}} />)\n\n    await waitForInputsToBeReady()\n    await sendInput(renderInstance, '1', '0')\n\n    expect(renderInstance.lastFrame()).toMatchInlineSnapshot(`\n      \"   (1) First\n         (2) Second\n      \u001b[36m>\u001b[39m  \u001b[36m(10) Tenth\u001b[39m\n\n         \u001b[2mnavigate with arrows, enter to select\u001b[22m\"\n    `)\n  })\n\n  test('handles custom keys', async () => {\n    const items = [\n      {\n        label: 'First',\n        value: 'first',\n      },\n      {\n        label: 'Second',\n        value: 'second',\n      },\n      {\n        label: 'Third',\n        value: 'third',\n        key: 't',\n      },\n    ]\n\n    const renderInstance = render(<SelectInput items={items} onSelect={() => {}} />)\n\n    await waitForInputsToBeReady()\n    await sendInput(renderInstance, 't')\n\n    expect(renderInstance.lastFrame()).toMatchInlineSnapshot(`\n      \"   (1) First\n         (2) Second\n      \u001b[36m>\u001b[39m  \u001b[36m(t) Third\u001b[39m\n\n         \u001b[2mnavigate with arrows, enter to select\u001b[22m\"\n    `)\n  })\n\n  test('rotate after reaching the end of the list', async () => {\n    const items = [\n      {\n        label: 'First',\n        value: 'first',\n      },\n      {\n        label: 'Second',\n        value: 'second',\n      },\n      {\n        label: 'Third',\n        value: 'third',\n      },\n    ]\n\n    const renderInstance = render(<SelectInput items={items} onSelect={() => {}} />)\n\n    await waitForInputsToBeReady()\n    await sendInput(renderInstance, ARROW_DOWN)\n    await sendInput(renderInstance, ARROW_DOWN)\n    await sendInput(renderInstance, ARROW_DOWN)\n\n    expect(renderInstance.lastFrame()).toMatchInlineSnapshot(`\n      \"\u001b[36m>\u001b[39m  \u001b[36m(1) First\u001b[39m\n         (2) Second\n         (3) Third\n\n         \u001b[2mnavigate with arrows, enter to select\u001b[22m\"\n    `)\n  })\n\n  test('support groups', async () => {\n    const items = [\n      {label: 'first', value: 'first', key: 'f'},\n      {label: 'second', value: 'second', key: 's'},\n      {label: 'third', value: 'third'},\n      {label: 'fourth', value: 'fourth'},\n      {label: 'fifth', value: 'fifth', group: 'Automations'},\n      {label: 'sixth', value: 'sixth', group: 'Automations'},\n      {label: 'seventh', value: 'seventh'},\n      {label: 'eighth', value: 'eighth', group: 'Merchant Admin'},\n      {label: 'ninth', value: 'ninth', group: 'Merchant Admin'},\n      {label: 'tenth', value: 'tenth'},\n    ]\n\n    const renderInstance = render(<SelectInput items={items} onSelect={() => {}} />)\n\n    expect(renderInstance.lastFrame()).toMatchInlineSnapshot(`\n      \"\u001b[36m>\u001b[39m  \u001b[36m(f) first\u001b[39m\n         (s) second\n         (3) third\n         (4) fourth\n         (5) seventh\n         (6) tenth\n\n         \u001b[1mAutomations\u001b[22m\n         (7) fifth\n         (8) sixth\n\n         \u001b[1mMerchant Admin\u001b[22m\n         (9) eighth\n         (10) ninth\n\n         \u001b[2mnavigate with arrows, enter to select\u001b[22m\"\n    `)\n  })\n})\n"]}